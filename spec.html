<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
    <title>Footprints Specification</title>
    <script async class="remove" src="//www.w3.org/Tools/respec/respec-w3c-common">
    </script>
    <script class="remove">
      var respecConfig = {
        shortName:      "footprints-spec",
        specStatus:     "ED",
        // specStatus:     "WG-NOTE",
        noRecTrack: true,
        edDraftURI:  "https://w3c.github.io/mynote/",
        editors:  [
          { name: "Eric Prud'hommeaux" , w3cid: "2112" }
        ],
        cg: "Solid",
        wgURI: "https://www.w3.org/community/solid/",
        // wgPatentURI:  "https://www.w3.org/2004/01/pp-impl/53154/status",
        github: {
          repoURL: "https://github.com/w3c/mynote/",
          branch: "master"
        },
        contributing: [
          "https://github.com/w3c/respec/wiki"
        ]
      };
    </script>
    <style>
      span.hljs-class { color: #4078f2; font-weight: bold; }
      span.hljs-name { color: #4078f2; }
      .excode::before { content: "[example code]"; font-size: small; vertical-align: top; background-color: buttonface }      
    </style>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css"/>
  </head>
  <body>

    <section id="abstract">
      <p>
        Semantic Web Applications interoperate by sharing semantics of terms and constellations of data structures.
        This specification defines Footprints, a mechanism for declaring and operating over constellations of data structures.
      </p>
    </section>

    <section id="sotd">
      <p>
        This is a proposal for the structure and use of Footprints in Solid.
        It is possible that this or a derivative document will become a Solid specification.
      </p>
    </section>

    <section id="terms">
      <h2>Terms</h2>
      <p>
        The following types and functions are used throughout this specification:
      </p>
      <ul>
        <li>types:
        <ul>
          <li><b>Container</b> -- a [[[LDP]]] [[LDP]] Container</li>
          <li><b>Footprint</b> -- an RDF structure defining the (contiguous) hierarchy and associated shapes of a Containers and the Resources which may populate those Containers.</li>
          <li><b>Managed Container</b> -- any LDP Container which is directly associated with Footprint, or is hierarchically nested within a an LDP Container which is directly associated with Footprint.</li>
          <li><b>Unmanaged Container</b> -- any LDP Container which is not a Managed Container.</li>
          <li><b>Supported RDF Format</b> -- a textual representation of an RDF graph in a format that can be accurately and losslessly parsed to that RDF graph.</li>
          <li><b>Body Graph</b> -- the RDF graph derived from parsing the body of an HTTP request with a parser determined by the Content-type: header of that HTTP request.</li>
          <li><b>Static Container</b> -- an LDP Container which is implied by the existence of the parent resource</li>
        </ul>
        </li>
        <li>functions:
        <ul>
          <li><b>instantiate (resource, contents)</b> --
          <ul>
            <li>Make <code>contents</code> available by GET request to <code>resource</code>.</li>
            <li>Let <code>parent</code> be the result of resolving the relative URL <code>..</code> against <code>resource</code>.<br/>
            Add the triple {<code>parent</code> ldp:contains <code>resource</code>} to <code>parent</code>.</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      <div class="issue">
      <p>
        Are "footprints" the resource trees in the POD or declarative descriptions thereof?
      </p>
      <p>
        Earlier discussions of "Footprints" imply that they describe how application data appears in a POD.
        These don't provide a name for an instantiation of that data in the POD.
        It might make more sense to have a shared "FootprintDescription" which describes the instantiations which would be called "Footprints".
        As it stands, we have a collection of related-sounding terms ("footprint", "step", "path") but our real-world intuitions about their interrelationships don't apply to their use in this spec.
        Also, the spec and primer say "instance" over and over again.
      </p>
      </div>
    </section>

    <section id="stomped">
      <h2>STOMP</h2>
      <p>
        A STOMP request is a POST P to an unmanaged Container with a Link header with rel="footprint" and a request body Content-type of some supported RDF Format.
        The Body Graph of a STOMP request identifies the application with a <span class="nohighlight">ldp:app</span> property and a human-readable name for the application in the preferred system language.
        This graph conforms to:
      </p>
      <div>
        <pre><code class="shexc">
&lt;#StompBody&gt; {
  ldp:app IRI {
    ldp:name xsd:string
  }
}
        </code></pre>
      </div>
      <p>
        A POD recieving a STOMP request <code>S</code> with a Link: rel="footprint" <code>F</code> and request body <code>B</code> to an Unmanaged Container <code>C</code> MUST parse <code>B</code> MUST instantiate:
      </p>
      <ul>
        <li>
          an <b>application Container</b> -- an RDF graph conformant with <span class="hljs-name">&lt;#InstalledApp&gt;</span>:
          <div>
            <pre><code class="shexc">
&lt;#InstalledApp&gt; {
  foot:installedIn @&lt;#Installation&gt;+
}

&lt;#Installation&gt; {
  foot:app @&lt;#App&gt; ;
  foot:footprintRoot IRI ;
  foot:footprintInstancePath xsd:string ;
  foot:instantiationDateTime xsd:dateTime ;
}

&lt;#App&gt; { foot:name xsd:string }
            </code></pre>
          </div>
        </li>
        <li>
          <p>
            a <b>footprint instance root</b> and nested Static Containers created by applying <a>instantiate static</a>(<code>F</code>, ".")
          </p>
          <!-- div>
            <pre><code class="shexc">
&lt;#FootprintInstanceRoot&gt; {
  a [ldp:BasicContainer] ;
  dc:title  xsd:string ;
  ldp:contains @&lt;#Instance&gt; .
}
&lt;Instance/&gt;  {
  foot:footprint IRI
}
            </code></pre>
          </div -->
        </li>
      </ul>
      <p>
        To guarantee stability and access to the footprint document and the schemas to which it refers, the POD SHOULD cache them.
      </p>
    </section>

    <section>
      <h2>Footprint Navigation</h2>
      <ul>
        <li><b>Footprint Instantiation Root</b> -- the URL of a footprint .</li>
        <li><b>Footprint Instantiation Path</b> -- a relative IRI identifying a location within a footprint. </li>
        <li><b>Footprint Instantiation Step</b> -- a location within a footprint identified by the IRI of the subject node of that step in the footprint.</li>
      </ul>
      <p>
        <dfn>instantiate static</dfn> (<code>footprintInstantiationStep</code>, <code>footprintStep</code>) instantiates the Static Containers implied by footprintInstantiationStep <a class="excode" href="https://github.com/janeirodigital/footprint-tests/blob/master/util/footprint.js#L304-L324"></a>
      </p>
      <ul>
        <li>for each <code>t</code> in footprint:contents
          <ul>
            <li>if <code>t</code> has an rdf:label <code>l</code>
              <ul>
                <li>
          <p>
            instantiate a <b>footprint instance step</b> -- an RDF graph conformant with <span class="hljs-name">&lt;#FootprintInstanceStep&gt;</span> below:
          </p>
          <div>
            <pre><code class="shexc">
&lt;#FootprintInstanceStep&gt; {
  a [ldp:BasicContainer] ;
  dc:title  xsd:string ;
  ldp:contains @&lt;#Instance&gt; * .
}
&lt;Instance/&gt;  {
  foot:footprint IRI
}
            </code></pre>
          </div>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <ul>
            <li>
              <ul>
                <li>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <ul>
            <li>
              <ul>
                <li>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </section>

    <section id="conformance">
      <h2>Conformance</h2>
      <p>
        This document uses RFC2119 keywords in the usual manner.
        All sections in this document are normative.
      </p>
    </section>

    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight.pack.js"></script>
    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script>
    <!-- <script src="WWW/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script> -->
    <script>
      // TODO: add ShEx highlighter to respec
      hljs.registerLanguage('shexc', hljsDefineShExC);
      hljs.registerLanguage('turtle', hljsDefineTExpr);
      (['DOMContentLoaded', 'load']).forEach(e => addEventListener(e, init, false));
      let inited = false;

      function hljsDefineTExpr (highlightjs) { // works pretty well for Turtle.
        const ret = hljsDefineShExC(highlightjs, 'tripleConstraint');
        ret.disableAutodetect = true;
        return ret;
      }

      function init () {
        if (inited) return;
        inited = true;
        ([400, 800, 1600]).forEach(
          tOut => setTimeout(highlightAll, tOut)
        )
      }

      function highlightAll () {
        console.log(new Date())
        try {
          const blocks = document.querySelectorAll('.shexc,.turtle');
          [].forEach.call(blocks, (b) => {
            hljs.highlightBlock(b);
          });
        } catch (e) {}
      }
    </script>
  </body>
</html>
