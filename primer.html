<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
    <title>Footprints Primer</title>
    <script async class="remove" src="https://www.w3.org/Tools/respec/respec-w3c-common">
    </script>
    <script class="remove">
      var respecConfig = {
        shortName:      "footprints-spec",
        specStatus:     "ED",
        // specStatus:     "WG-NOTE",
        noRecTrack: true,
        edDraftURI:  "https://w3c.github.io/mynote/",
        editors:  [
          { name: "Eric Prud'hommeaux" , w3cid: "2112" }
        ],
        cg: "Solid",
        wgURI: "https://www.w3.org/community/solid/",
        // wgPatentURI:  "https://www.w3.org/2004/01/pp-impl/53154/status",
        github: {
          repoURL: "https://github.com/w3c/mynote/",
          branch: "master"
        },
      };
    </script>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css"/>
    <style>
      .excode::before { content: "[example code]"; font-size: small; vertical-align: top; background-color: buttonface }
    </style>
  </head>
  <body>

    <section id="abstract">
      <p>
        Semantic Web Applications interoperate by sharing semantics of terms and constellations of data structures.
        This primer introduces Footprints and describes how Semantic Web Applications use them to consistently interoperate over constellations of data structures.
      </p>
    </section>

    <section id="sotd">
      <p>
        This is a proposal for the structure and use of Footprints in Solid.
        It is possible that this or a derivative document will become a Solid specification.
      </p>
    </section>

    <section id="introduction">
      <h2>Introduction</h2>
      <p>
        A Footprint defines a constellation of related resources which combine to enable some task.
        The footprint associates each resource with a shape in a schema.
        This document uses three example tasks:
      </p>
      <ul>
        <li><b>PhotoAlbum</b> - collects photos or references to photos into sharable albums (<a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/photo/PhotoAlbumFootprint.ttl">footprint</a>, <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/photo/PhotoAlbum.shex">schema</a>).</li>
        <li><b>MultiCal</b> - migrates calendar applications between two common formats, "Common" (<a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/CalendarFootprint.ttl">footprint</a>, <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/Calendar.shex">schema</a>), and "Google" (<a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/GoogleFootprint.ttl">footprint</a>, <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/GoogleCalendar.shex">schema</a>).</li>
        <li><b>GitHub</b> - a storage repository associating users or groups with repositories, issues and events (<a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/gh/ghFootprint.ttl">footprint</a>, <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/gh/ghSchema.shex">schema</a>).</li>
      </ul>
      <p>
        Each of the above footprints is available in Turtle or JSON-LD.
        You can change the <code>.ttl</code> extension to <code>.jsonld</code> to see the JSON-LD.
      </p>
    </section>

    <section id="stomp">
      <h2>Stomping a Footprint</h2>
      <p>
        The first application using a particular footprint must ask the POD to allocate the ldp:Containers defined in the footprint.
        This is done with a <b>STOMP</b> operation, a POST to the parent Container with a <code>rel="footprint"</code> Link header <a class="excode" href="https://github.com/janeirodigital/footprint-tests/blob/master/test/test-harness.js#L63-L69"></a>.
        The MultiCal application may know that it has permissions to create Containers in the POD's <code>/Shared</code> Container.
        It would request the POD to create a <code>Calendar</code> Container associated with the "CommonCalendar" application:
      </p>
      <div class="example">
        <p><a href="https://github.com/janeirodigital/footprint-tests/blob/master/test/cal.test.js#L47-L48">associated test</a></p>
        <pre class="http nohighlight"><code>
POST /Shared/
Slug: Calendar
Link: &lt;http://www.w3.org/ns/ldp#Container&gt;; rel="type"
Link: <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/CalendarFootprint.jsonld">http://.../cal/CalendarFootprint#calendar</a>; rel="footprint"
        </code></pre>
      </div>
      <p>
        The footprint will identify one or more Containers into which the application may store Resources.
        The Calendar application's footprint starts from the <code>#calendar</code> node, which happens to be the JSON root in this JSON-LD expression of the footprint:
      </p>
      <div class="example">
        <pre><code class="js">
{ "@context": { ... },
  "@id": "#calendar",
  "type":"ldp:BasicContainer",
  "shape": "Calendar#Calendar",
  "contents":[
    { "@id": "#appointment",
      "type":"ldp:Resource",
      "uriTemplate":"{appointmentNo}",
      "shape": "Calendar#Appointment" }
] }
        </code></pre></div>

      <section id="stomped-image">
        <h3>Stomped Image on POD</h3>
        <p>
          A POD server recieving a STOMP <a class="excode" href="https://github.com/janeirodigital/footprint-tests/blob/master/ldpServer.js#L47-L78"></a>
        </p>
        <p class="issue">
          It's likely that we want to let the client decide when to re-use an existing footprint (i.e. reuse <a href="#discovery">discovery</a>), but it's possible to have the POD reuse an existing footprint <a class="excode" href="https://github.com/janeirodigital/footprint-tests/blob/master/ldpServer.js#L50-L60"></a> and retrun a 304 (no body allowed on a 304).
        </p>
      </section>

      <section id="stomp">
        <h3>Multi-Footprint Applications</h3>
        <p>
          Because MultiCal is a gateway between multiple event formats, it registers a second footprint:
        </p>
        <div class="example">
          <p><a href="https://github.com/janeirodigital/footprint-tests/blob/master/test/cal.test.js#L56-L57">associated test</a></p>
          <pre class="http nohighlight"><code>
POST /Shared/
Slug: Google
Link: &lt;http://www.w3.org/ns/ldp#Container&gt;; rel="type"
Link: <a href="https://github.com/janeirodigital/footprint-tests/blob/master/solidApps/staticRoot/cal/GoogleFootprint.jsonld">http://.../cal/GoogleFootprint#top</a>; rel="footprint"
          </code></pre>
        </div>
        <p>
          This footprint provisions a nested container called <code>Events</code> and specifies that every event in that container conform to the <code>&lt;EventShape&gt;</code>.
        </p>
        <div class="example">
          <pre><code class="js">
{ "@context": { ... },

  "@id": "#top",
  "type": "ldp:BasicContainer" ,
  "contents": [
    { "@id": "#Events",
      "type": "ldp:BasicContainer" ,
      "name": "Events",
      "contents": [
        { "@id": "#Event",
          "type": "ldp:Resource",
          "uriTemplate": "{EventName}",
          "shape": "GoogleCalendar#EventShape" }
    ] }
] }
          </code></pre>
        </div>
      </section>
    </section>

    <section id="discovery">
      <h2>Discovery</h2>
    </section>


    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight.pack.js"></script>
    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script>
    <!-- <script src="WWW/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script> -->
    <script>
      function hljsDefineTExpr (highlightjs) {
        const ret = hljsDefineShExC(highlightjs, 'tripleConstraint');
        ret.disableAutodetect = true;
        return ret;
      }
      hljs.registerLanguage('shexc', hljsDefineShExC);
      hljs.registerLanguage('turtle', hljsDefineTExpr);
      (['DOMContentLoaded', 'load']).forEach(e => addEventListener(e, init, false));
      let inited = false;
      function init () {
        if (inited) return;
        inited = true;debugger
        const blocks = document.querySelectorAll('.shexc,.turtle');
        [].forEach.call(blocks, (b) => { // TODO: add ShEx highlighter to respec
          setTimeout(_ => {try { hljs.highlightBlock(b); } catch (e) {}}, 500)
        });
      }
    </script>
  </body>
</html>
