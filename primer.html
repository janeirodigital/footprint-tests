<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
    <title>Footprints Primer</title>
    <script async class="remove" src="//www.w3.org/Tools/respec/respec-w3c-common">
    </script>
    <script class="remove">
      var respecConfig = {
        shortName:      "footprints-spec",
        specStatus:     "ED",
        // specStatus:     "WG-NOTE",
        noRecTrack: true,
        edDraftURI:  "https://janeirodigital.github.io/footprints/primer",
        editors:  [
          { name: "Eric Prud'hommeaux" , w3cid: "2112" },
          { name: "Justin Bingham" }
        ],
        cg: "Solid",
        wgURI: "https://www.w3.org/community/solid/",
        // wgPatentURI:  "https://www.w3.org/2004/01/pp-impl/53154/status",
        github: {
          repoURL: "https://github.com/janeirodigital/footprints/",
          branch: "master"
        },
      };
    </script>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css"/>
    <link rel="stylesheet" href="local.css"/>
    <style>
.cross::before { content: "(see spec)"; font-size: small; vertical-align: top; background-color: buttonface; }

/* draw tree per https://two-wrongs.com/draw-a-tree-structure-with-only-css */
.clt, .clt ul, .clt li {
     position: relative;
}

.clt ul {
    list-style: none;
    padding-left: 32px;
}
.clt li::before, .clt li::after {
    content: "";
    position: absolute;
    left: -12px;
}
.clt li::before {
    border-top: 1px solid #000;
    top: 9px;
    width: 8px;
    height: 0;
}
.clt li::after {
    border-left: 1px solid #000;
    height: 100%;
    width: 0px;
    top: 2px;
}
.clt ul > li:last-child::after {
    height: 8px;
}
li.choice {
    list-style999: none;
    margin-left999: -2.5em;
    padding-left: .2em;
    border-left: .5em solid #a7a;
}
li.choice > ul > li {
}
.choice .either {
    font-weight: bold;
    color: #747;
}
    </style>
  </head>
  <body>

    <section id="abstract">
      <p>
        Semantic Web Applications interoperate by sharing semantics of terms and constellations of data structures.
        This primer introduces <span class="blueprint-label capitol plural">Footprints</span> and describes how Semantic Web Applications use them to consistently interoperate over constellations of data structures organized in resource hierarchies used by protocols such as <a href="https://www.w3.org/TR/ldp/">LDP</a> and <a href="https://www.solidproject.org">Solid</a>.
      </p>
    </section>

    <section id="sotd">
      <p>
        This is a proposal for the structure and use of <span class="blueprint-label capitol plural">Footprints</span> in Solid.
        It is possible that this or a derivative document will become a Solid specification.
      </p>
    </section>

    <section id="introduction">
      <h2>Introduction</h2>
      <p>
        Realizing the value proposition of the Semantic Web lies in building useful and robust applications that can interoperate over linked data.
        Protocols such as <a href="https://www.w3.org/TR/ldp/">LDP</a> and <a href="https://www.solidproject.org">Solid</a> organize linked data graphs into resource hierarchies, providing a foundation upon which these robust and interoperable applications can be created.
      </p>
      <p>
        Application interoperability depends on applications sharing semantics for relationships and data structures.
        RDF&apos;s foundation in unambiguous identifiers provides an infrastructure that allows for interoperability without specifically encouraging it.
        Within a single resource, shapes languages (e.g. ShEx and SHACL) provide machine-readable, enforceable data structure definitions.
        For applications that operate on constellations of resources, <span class="blueprint-label capitol plural">Footprints</span> express the layout of those resources and associate them with their respective shapes.
      </p>
      <p>
        Footprints marry RDF vocabularies, shapes, and resources into "little trees" that
        provide detailed blueprints for machine to machine interoperability,
        while at the same time creating models and representions that humans can
        easily comprehend, such as medical records, notes, notebooks,
        calendars, and financial records. Consequently, we can use footprints to provide
        data boundaries that machines can interoperate with and humans can understand.
      </p>
      <p>
        A <span class="blueprint-label">footprint</span> defines a prospective tree of related resources which can be read and written by applications.
        The <span class="blueprint-label">footprint</span> associates each of these resources with a shape.
        This allows one to treat a set of related resources as a single grouping, and apply that to a range of operations including access control, data organization, data validation, and data migration.
        Since the footprint boundaries that establish these groupings are easily understood by humans, it allows them to perform these operations intuitively.
      </p>
      <p>
        The hierarchy implied by the <span class="blueprint-label">footprint</span> provides a default resource layout.
        When a new instance is needed for storage, an application can <span class="stamp-label">create</span> a new <span class="imprint-label">instance</span>.
        However, in the spirit of any good REST application, the application should not require the arrangement of data resources to conform to the <span class="blueprint-label">footprint</span>.
      </p>
      <p>
        <span class="blueprint-label capitol plural">Footprints</span> are defined as an RDF graph structure and a set of expected behaviors of agents respecting that graph structure.
        These semantics can be implemented by a server, a client-side library, or a privilenged third-party helper application.
        Communication, including error reporting, is defined in terms of HTTP; allowing a single definition to define the behaviors for servers, clients and third-party applications.
      </p>
    </section>

    <section id="structure">
      <h2><span class="blueprint-label capitol">Footprint</span> Structure <a class="cross" href="spec#structure"></a></h2>
      <p>
        The following image introduces <span class="blueprint-label plural">footprints</span> by way of an example footprint for interoperable notes called "CommonNote".
        It captures notes, any images included therein, as well as the note&apos;s citations.
      </p>
      <p>
        The example image includes three columns:
      </p>
      <ol>
        <li>Shape definitions (expressed in ShEx) for the resources described by the CommonNote <span class="blueprint-label">footprint</span></li>
        <li>A <span class="blueprint-label">footprint</span> (expressed in Turtle) for CommonNote</li>
        <li>Example <span class="imprint-label plural">instances</span> of the CommonNote <span class="blueprint-label">footprint</span> (a "resource hierarchy")</li>
      </ol>
        <style>
#img1 > img {
    width: 90%;
    height: auto;
    padding-left: 5%;
    align-self: self-start;
    /* object-fit: cover; */
}
#img1 > span {
    text-decoration: underline;
    padding: 0 9ex;
}
        </style>
      <div id="img1">
<span>Shapes (ShEx)</span>
<span><span class="blueprint-label capitol">Footprint</span> (Turtle)</span>
<span>Resource Tree</span>
        <!-- div style="float:left; width:30%; font-size: 1.2ex;">
          <span style="text-decoration: underline; padding-left: 10ex;"><span class="blueprint-label capitol">Footprint</span> (Turtle)</span>
          <pre style="border-width: medium; border-left-style:solid; border-right-style:solid; border-color: #3366aa; background-color: #f3f6ff; border-top-style:solid; border-top-color: black;">&lt;#container&gt; foot:type ldp:Container ;
  foot:contents &lt;#note&gt; .</pre>

          <pre style="border-width: medium; border-left-style:solid; border-right-style:solid; border-color: #aa3366; background-color: #fff3f6;">&lt;#note&gt; foot:type ldp:Container ;
  foot:uriTemplate "{noteName}" ;
  foot:shape &lt;CommonNote#Note&gt; ;
  foot:contents &lt;#citation&gt;,&lt;#image&gt;.</pre>

          <pre style="border-width: medium; border-left-style:solid; border-right-style:solid; border-color: #6633aa; background-color: #f6f3ff;">&lt;#citation&gt; foot:type ldp:Resource ;
  foot:uriTemplate "inc-{name}" ;
  foot:shape &lt;CommonNote#Citation&gt; .</pre>

          <pre style="border-width: medium; border-left-style:solid; border-right-style:solid; border-color: #66aa33; background-color: #f6fff3;; border-bottom-style:solid; border-bottom-color: black;">&lt;#image&gt; foot:type ldp:NonRDFSource ;
  foot:uriTemplate "img-{name}" .</pre>
        </div -->
        <!-- <img style="float:left;width:70%" src="blueprint.svg" alt="colored example of ShEx schema, footprint structure, and resource hierarchy"/> -->
        <!-- <div style="clear:both;"></div> -->
        <img src="blueprint.svg" alt="colored example of ShEx schema, footprint, and resource hierarchy"/>
      </div>
      <p>
        Here, <code style="color: #005555;">/data/medicalNotes</code> and <code style="color: #005555;">/data/astronomy/notes</code> are both <span class="imprint-label plural">imprints</span> of the <code style="color: #005555;">&lt;#container&gt;</code> <span class="blueprint-label">footprint</span> step.
        They are both LDP Containers per <code style="color: #005555;">&lt;#container&gt; foot:type ldp:Container</code> and could contain any number of note footprints per <code style="color: #005555;">foot:contents &lt;#note&gt;</code>.
        In this example, <code style="color: #770033;">xrays-2019-08</code>, <code style="color: #770033;">GP-2020-04-18</code> and <code style="color: #770033;">blue-shift</code> respectively are <span class="imprint-label plural">instances</span> of the <code style="color: #770033;">&lt;#note&gt;</code> <span class="blueprint-label">footprint</span>.
        Each contains a binary <code style="color: #337700;">image</code> and blue-shift has a <code style="color: #330077;">citation</code>.
      </p>
      <p>
        The <span class="blueprint-label">footprint</span> is broken up into steps. A given step in a footprint can be referenced and used on its own as a standalone footprint.
        The step describing the <code style="color: #330077;">citation</code> has the subject node <code style="color: #330077;">&lt;#citation&gt;</code>.
        This step asserts that associated resources (e.g. <code style="color: #330077;">cit-M33.ttl</code>) must be LDP Resources per <code style="color: #330077;">&lt;#citation&gt; foot:type ldp:Resource</code>, must have a name matching a URI template (i.e. must start with "cit-") per <code style="color: #330077;">&lt;#citation&gt; foot:uriTemplate "cit-{name}"</code>, and must conform to the shape <code style="color: #330077;">&lt;CommonNote#Citation&gt;</code> per <code style="color: #330077;">&lt;#citation&gt; foot:shape &lt;CommonNote#Citation&gt;</code>.
      </p>
        <style>
#img2 > img {
    float:left;
    width: 30%;
    height: auto;
    padding-left: 5%;
    align-self: self-start;
    /* object-fit: cover; */
}
#img2 > div {
    float:left;
    width:65%;
}
.proscons > div {
    float:left; width: 49%
}
.proscons > div:nth-child(1) {
    border-right: medium solid black;
}
.proscons > div > p {
    font-weight: bold;
    text-align: center;
    margin: 0;
    border-bottom: medium solid black;
}
        </style>
        <div id="img2">
          <div>
            <p>
              The above resource hierarchy includes multiple <span class="imprint-label plural">instances</span> for medical and astronomy notes.
              Many systems make life simpler for users by providing dedicated places to store specific types of data structures.
              This provides applications with the ability to store data without prompting the user for a storage target.
            </p>
            <p>
              The example on the right implies a single location to store all CommonNote <code style="color: #770033;">&lt;#note&gt;</code> instances.
              The resource name for these individual <code style="color: #770033;">&lt;#note&gt;</code> instances could come from the footprint name, a randomly generated sequence like a uuid, or some other opaque identifier invented by the system.
              Validation by the <code style="color: #005555;">&lt;#container&gt;</code> footprint ensures only <code style="color: #770033;">&lt;#note&gt;</code> instances can be stored.
              Instances of <code style="color: #770033;">&lt;#note&gt;</code> footprints can be discovered easily in this scheme, and the layout is conducive to tag-based organization and access control.
            </p>
          </div>
        <img src="mono-footprint.svg" alt="colored example of single-instance resource hierarchy"/>
      </div>
      <div style="clear:both"></div>
      <div class="issue">
        <p>
          Should footprints include a step for their managed container?
          In the above <span class="blueprint-label">footprint</span>, the triples:
        </p>
        <pre style="color: #005555;" class="plaintext">
&lt;#container&gt; foot:type ldp:Container ;
  foot:contents &lt;#note&gt; .
        </pre>
        <p>
          describe not an instance of a note but a container of such instances.
          Without these triples, the outer-most step (the one that is not the object of any <code>foot:contents</code> arcs) is <code>&lt;#note&gt;</code>.
          This makes it easier to, at a high-level, assert that the <span class="blueprint-label">footprint</span> is about Notes rather than containers of notes.
        </p>
        <div class="proscons">
          <div>
            <p>Reasons not to include</p>
            <ol>
              <li>Simplifies message.</li>
              <li>Aligns with traditional patterns for data modeling and separation of concern</li>
              <li>Could either:<ul>
              <li>Describe outer container with a second footprint,</li>
              <li>Leave content model of outer container implicit in the existance of any footprint doc (i.e. system automatically creates a container for it).</li>
            </ul></li>
            </ol>
          </div>
          <div>
            <p>Reasons to include</p>
            <ol>
              <li>Re-uses existing mechanism (<code>foot:contents</code>) for declaring a container content model.<br/>
              This works for homogeneous and heterogeneous (those with multiple types of members)</li>
              <li>avoids either:<ul>
              <li>Second footprint,</li>
              <li>Implicit containership semantics.</li>
            </ul></li>
            </ol>
          </div>
          <div style="clear:both;"></div>
        </div>
      </div>
      <p>
        A <span class="blueprint-label">footprint</span> is a tree structure of <dfn>steps</dfn> which in turn describes a tree structure of Resources (effectively a hierarchy of directories and files).
        Each step can be referenced and used on its own as a standalone footprint. Each file or directory is described by <a>step</a>.
      </p>
      <p>
        A step consists of:
      </p>
      <ul>
        <li>an <dfn>id</dfn>: an addressable label for this step.<br/>
        As with all RDF structures, providing an id makes is possible to address this entity from outside the document.</li>
        <li>a <dfn>type</dfn>: LDP type of the associated resource: <code>BasicContainer</code> OR <code>Resource</code>.<br/>
        Each step in a <span class="blueprint-label">footprint</span> defines a resource in an LDP hierarchy.
        The type specifies whether the associated resources should be LDP:BasicContainers or LDP:Resources.</li>
        <li class="choice"><span class="either">either of:</span>
        <ul>
          <li>a <dfn>label</dfn>: label for a resource which will always be created;<br/>
          This is used when resources with specific names will appear in the resource hierarchy.</li>
          <li>a <dfn>uriTemplate</dfn>: pattern for a resource to be matched against a POSTed Slug: header <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/util/blueprint.js#L280-L297"></a>.<br/>
          This is used when the client gets to choose the name of a resource by including a Slug header in the request.</li>
        </ul>
        </li>
        <li>any number of <dfn>uses</dfn>: identifies related <span class="blueprint-label plural">footprints</span>.<br/>
        These provide advice that the data in resources described by this step references another <span class="blueprint-label">footprint</span>.</li>
        <li class="choice"><span class="either">either of:</span>
        <ul>
          <li>a <dfn>shape</dfn>: The RDF graph structure of any POSTed or PUT resource must conform to this shape;<br/>
          This allows <span class="blueprint-label plural">footprints</span> to ensure that the data in the resource hierarchy conforms to the expected schemas.</li>
          <li>a <dfn>mediaType</dfn>: any non-RDF type must specify a media type or a media tree.<br/>
          This specifies the expected media type or media tree for non-RDF resources.</li>
        </ul>
        </li>
        <li>an optional <dfn>contents</dfn>: a list of nested steps.<br/>
        This captures the containership of a conforming resource hierarchy.</li>
      </ul>
      <!--
      <p>
        The outer-most step must have an <a>id</a>, has neither a <a>label</a> nor a <a>uriTemplate</a> and has at least one <a>contents</a> arc.
        The PhotoApp has a simple <span class="blueprint-label capitol">Footprint</span> <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/photo/PhotoBlueprint.jsonld"></a> <span class="issue">Finding it hard to extract much from this example.</span>:
      </p>
      <div>
        <pre><code class="json">
{ "@id": "#root", "type":"ldp:BasicContainer", "contents":[
  { "@id": "#image",
    "type": "ldp:BinaryResource",
    "uriTemplate": "{entryName}",
    "shape": "Photo#Photo"
  }
] }</code></pre>
      </div>
      <p>
        The PhotoAlbumApp&apos;s <span class="blueprint-label capitol">Footprint</span> <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/album/PhotoAlbumBlueprint.jsonld"></a> uses uriTemplates to discriminate between different types of Resource.
        The top Container holds both images and references.
        They are distinguised by their name, either "img-..." or "ref-...".
        Any entry which is POSTed to the Container must have a Slug: header which matches one of the <a>uriTemplates</a>.
        That match determines the shape for validation and the metadata that the POD will store about the new-created Container member:
      </p>
      <div>
        <pre><code class="json">
{ "@id": "#root", "type": "ldp:BasicContainer", "contents": [
  { "@id": "#img-ref", "type": "ldp:Resource",
    "uriTemplate": "ref-{entryNo}", "shape": "PhotoAlbum#PhotoReference" },
  { "@id":  "#image", "type": "ldp:BinaryResource",
    "uriTemplate": "img-{entryNo}"}
] }
</code></pre>
      </div>
      <p>
        For an example of a complex <span class="blueprint-label capitol">Footprint</span>, the GitApp has a deeply-nested <span class="blueprint-label capitol">Footprint</span> <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/gh/ghBlueprint.jsonld"></a>.
      </p>
      -->
    </section>

    <section id="creating">
      <h2>Creating a New Container for Footprints</h2>
      <p>
        The above example describes an <span class="imprint-label">imprint</span> at <code style="color: #005555;">/data/CommonNotes</code>.
        This is an LDP Container which is constrained to contain only instances of <code>&lt;CommonNote<span class="blueprint-label capitol">Footprint</span>#note&gt;</code>.
        This container is described by the <span class="blueprint-label">footprint</span> <code>&lt;CommonNote<span class="blueprint-label capitol">Footprint</span>#container&gt;</code>:
      </p>
      <pre><code class="nohighlight" style="color: #005555;">
&lt;#container&gt; foot:type ldp:Container ;
  foot:contents &lt;#note&gt; .
      </code></pre>
      <p>
        In order to create this, an application like NeverNote would use a <b><span class="stamp-label">stamp</span></b> operation to create an <span class="imprint-label">imprint</span> of the <code style="color: #005555;">&lt;#container&gt;</code> <span class="blueprint-label">footprint</span> step.
        This <span class="stamp-label">stamp</span> operation is a POST to the parent Container with a <code>rel="<span class="blueprint-label">footprint</span>"</code> Link header <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/test/test-harness.js#L63-L69"></a>.
        The resulting LDP Container for CommonNotes is expected to be shared with other applications.
        Below, we use the name "OtherNote" as an example of another application which can consume and process data conforming to the shapes referenced by the CommonNote footprint.
      </p>
      <div class="example">
        <p><a href="https://github.com/janeirodigital/footprints/blob/master/test/cal.test.js#L47-L48">associated test</a></p>
        <pre class="http nohighlight"><code>
POST /data/
Slug: CommonNotes
Link: &lt;http://www.w3.org/ns/ldp#Container&gt;; rel="type"
Link: &lt;<a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/nevernote/NeverNoteBlueprint.jsonld">http://commonnote.example/CommonNote<span class="blueprint-label capitol">Footprint</span>#container</a>&gt;; rel="<span class="blueprint-label">footprint</span>"
        </code></pre>
      </div>
      <p>
        The response identifies a LDP Container for CommonNotes notes:
      </p>
      <style>
        .caption { margin-bottom: -4ex; font-weight: bold; }
      </style>
      <div>
        <p class="caption">HTTP Response</p>
        <pre><code class="example footprint turtle">
HTTP 201 CREATED
Location: http://pod.example/data/CommonNotes/
Content-type: text/turtle; charset=utf-8
Content-length: 396

@prefix foot: &lt;http://www.w3.org/ns/blueprints#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.

[]  <!-- foot:app &lt;https://apps.example/NeverNoteApp&gt;; -->
    foot:blueprintRoot &lt;https://commonnote.example/CommonNote<span class="blueprint-label capitol">Footprint</span>#container&gt;;
    foot:blueprintInstancePath &lt;/data/CommonNotes/&gt;.
<!-- &lt;https://store.example/NeverNoteApp&gt; foot:name "NeverNoteApp".
&lt;https://localhost:12345/Apps/NeverNoteApp&gt; foot:installedIn _:b3. -->
        </code></pre>
      </div>

      <!-- <section id="stamped-image"> -->
      <!--   <h3>Resulting Footprint Instance on a Pod</h3> -->
        <p>
          <span class="stamp-label capitol gerund">Stamping</span> an <span class="imprint-label">imprint</span> results in a new LDP Container in the resource hierarchy.
          This information in this LDP Container is similar to the HTTP response to the <span class="stamp-label">stamp</span> operation:
        </p>
        <p class="caption">Contents of http://pod.example/data/CommonNotes/</p>
        <pre><code class="example footprint turtle">
@prefix ldp: &lt;http://www.w3.org/ns/ldp#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix foot: &lt;http://www.w3.org/ns/blueprints#&gt;.
@prefix dc: &lt;http://purl.org/dc/terms/&gt;.
@prefix dcterms: &lt;http://purl.org/dc/terms/&gt;.

&lt;&gt; a ldp:BasicContainer;
    dcterms:title "container for CommonNote<span class="blueprint-label capitol">Footprint</span>#container";
    foot:blueprintRoot &lt;https://commonnote.example/CommonNote<span class="blueprint-label capitol">Footprint</span>#container&gt;;
    foot:blueprintInstancePath ".";
    foot:blueprintInstanceRoot &lt;&gt;.
        </code></pre>
        <p>
          The agent handling the <span class="stamp-label">stamp</span> request manages the container artifact and any indexing of <span class="imprint-label plural">imprints</span>.
          It must:
        </p>
        <ul>
          <li>Create a Container for that <span class="imprint-label">imprint</span> (the name of which might respect the Slug: header).
          <!-- ul>
            <li>Create any nested-Containers which have <code>rdfs:label</code>s in the <span class="blueprint-label capitol">Footprint</span>.
            <code>&lt;CommonNote<span class="blueprint-label capitol">Footprint</span>#note&gt;</code> defines a heterogeneous container which can contain both citations (prefixed by "cit-") and images (prefixed by "img-").
            An alternate design would be to contain to homogeneous containers with fixed <code>rdfs:label</code>s:
            <pre><code class="nohighlight" style="color: #330077;">
&lt;#citation&gt; foot:type ldp:Container ;
  rdfs:label "citations" ;
  foot:shape &lt;CommonNote#Citation&gt; .
            </code></pre>
            <pre><code class="nohighlight" style="color: #337700;">
&lt;#image&gt; foot:type ldp:NonRDFSource ;
  rdfs:label "images" .
            </code></pre>
            In this case, every <span class="imprint-label">imprint</span> of a note would dictate the creation of two nested containers <code>citations</code> and <code>images</code>.
            An agent executing the <span class="blueprint-label">footprint</span> semantics would be expected to create those resources.
          </li>
          </ul -->
          </li>
          <!-- li>optionally index the <span class="blueprint-label">footprint</span>. This depends on the ecosystem; see the <a href="#crh-index-footprint">indexing a <span class="blueprint-label">footprint</span> in CRE</a> for a concrete example.</li -->
          <!-- <li>optionall register the application. This depends on the ecosystem; see the <a href="#crh-index-footprint">registering an agent in CRE</a> for a concrete example.</li> -->
        </ul>
      <!-- </section> -->
    </section>

    <section id="updating">
      <h2>Updating Footprint Instances <a class="cross" href="spec#post-managed"></a></h2>
      <p>
        Despite NeverNote having <span class="stamp-label past">stamped</span> the LDP Container <code>/data/CommonNotes</code>, it could be another application, OtherNote, which first creates data there.
        <!-- When an client application <span class="stamp-label capitol">Stamped</span>s a <span class="blueprint-label">footprint</span> <a class="excode" href="https://github.com/janeirodigital/footprints/blob/master/ldpServer.js#L47-L78"></a>, the POD will record the association between the create a an <code>instantiation</code> of tha.
        This defines -->
      </p>
      <p>
        When POSTing to any Instance Container, there will be a corresponding step in the <span class="blueprint-label capitol">Footprint</span>.
        If the step includes a shape, the POST must include a Link: rel="root" header to identify the node in the POSTed data that should conform to that shape.
      </p>
          <pre><code class="example footprint turtle">
POST /data/CommonNotes/
Link: &lt;#note1&gt;; rel="root"

PREFIX : &lt;http://nevernote.example/ns#&gt;
PREFIX ldp: &lt;http://www.w3.org/ns/ldp#&gt;
PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;
PREFIX geo: &lt;http://www.opengis.net/ont/geosparql#&gt;

&lt;#note1&gt;
  :title "Note1" ;
  :content "Don't believe the hype!" ;
  :updated "2020-01-01T12:34:00Z"^^xsd:dateTime ;
  :tagNames ("tag1" "tag2") .
          </code></pre>
      <p>
        When receiving a POST to a managed resource, an application POSTs to a Managed Container, the POD locates the corresponding step in the <span class="blueprint-label">footprint</span>.
        If the step includes a shape, the POST body is parsed and the root node is tested for conformance.
        If it&apos;s invalid, the requested with a 422 Unprocessable Entity message.
        If it&apos;s valid or has no associated shape, the typical LDP processing will create an entity whose contents include the POSTed body.
      </p>
      <!-- p>If processing produces no errors, the POD will again Create any sub-Containers which have <code>rdfs:label</code>s in the <span class="blueprint-label capitol">Footprint</span>.
      For instance, the <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/gh/ghBlueprint.ttl#L21">GitHub <span class="blueprint-label capitol">Footprint</span> step for {userName}</a> has a nested Containers <code>Subscriptions</code>s (and many others).
      </p -->
          <p>Otherwise, the response will identify the newly-created resource:</p>
          <pre><code class="example footprint turtle">
201 CREATED
Location: http://pod.example/data/CommonNotes/note1<!-- /img-M33_IR.jpg -->
          </code></pre>
          <p>and the resource hierarchy will include that resource:</p>
          <pre><code class="example footprint turtle">
@prefix ldp: &lt;http://www.w3.org/ns/ldp#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix foot: &lt;http://www.w3.org/ns/blueprints#&gt;.
@prefix dc: &lt;http://purl.org/dc/terms/&gt;.
@prefix dcterms: &lt;http://purl.org/dc/terms/&gt;.

&lt;&gt; a ldp:BasicContainer;
    dcterms:title "@@@ .";
    foot:blueprintRoot &lt;/data/CommonNotes<span class="blueprint-label capitol">Footprint</span>#container&gt;;
    foot:blueprintInstancePath ".";
    foot:blueprintInstanceRoot &lt;&gt;.
          </code></pre>
    </section>
    <!-- ul>
        <li><b>PhotoAlbum</b> - collects photos or references to photos into sharable albums (<span class="blueprint-label">footprint</span> <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/album/PhotoAlbumFootprint.ttl">Turtle</a> / <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/album/PhotoAlbumFootprint.jsonld">JSON-LD</a>, <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/album/PhotoAlbum.shex">schema</a>).</li>
        <li><b>MultiCal</b> - migrates calendar applications between two common formats, "Common" (<span class="blueprint-label">footprint</span> <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/CalendarFootprint.ttl">Turtle</a> / <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/CalendarFootprint.jsonld">JSON-LD</a>, <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/Calendar.shex">schema</a>), and "Google" (<span class="blueprint-label">footprint</span> <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/GoogleFootprint.ttl">Turtle</a> / <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/GoogleFootprint.jsonld">JSON-LD</a>, <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/cal/GoogleCalendar.shex">schema</a>).</li>
        <li><b>GitHub</b> - a storage repository associating users or groups with repositories, issues and events (<span class="blueprint-label">footprint</span> <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/gh/ghFootprint.ttl">Turtle</a> / <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/gh/ghFootprint.jsonld">JSON-LD</a>, <a href="https://github.com/janeirodigital/footprints/blob/master/solidApps/staticRoot/gh/ghSchema.shex">schema</a>).</li>
      </ul -->


    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight.pack.js"></script>
    <script src="http://www.w3.org/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script>
    <!-- <script src="WWW/2019/Talks/1209-swat4ls-egp/highlight-shexc.js"></script> -->
    <script>
      if (location.search) {debugger
        const [blueprint, imprint, stamp] = location.search.substr(1).split(/,/).map(unescape);
        function cap (elt, str) {
          return elt.classList.contains('capitol')
            ? str.substr(0, 1).toUpperCase() + str.substr(1)
            : str;
        }
        function pl (elt, str) {
          return elt.classList.contains('plural')
            ? str + 's'
            : str;
        }
        function trimVowel (str) {
          return str.match(/[aeiou]$/)
            ? str.substr(0, str.length - 1)
            : str;
        }
        document.title = blueprint.substr(0, 1).toUpperCase() + blueprint.substr(1) + 's Primer';
        document.querySelectorAll('.blueprint-label').forEach(elt => {
          elt.innerText = pl(elt, cap(elt, blueprint));
        })
        document.querySelectorAll('.imprint-label').forEach(elt => {
          elt.innerText = pl(elt, cap(elt, imprint));
        })
        document.querySelectorAll('.stamp-label').forEach(elt => {
          let text = cap(elt, stamp);
          if (elt.classList.contains('gerund'))
            text = trimVowel(text) + 'ing';
          if (elt.classList.contains('past'))
            text = trimVowel(text) + 'ed';
          elt.innerText = text;
        })
      }
      // TODO: add ShEx highlighter to respec
      hljs.registerLanguage('shexc', hljsDefineShExC);
      hljs.registerLanguage('turtle', hljsDefineTExpr);
      (['DOMContentLoaded', 'load']).forEach(e => addEventListener(e, init, false));
      let inited = false;

      function hljsDefineTExpr (highlightjs) { // works pretty well for Turtle.
        const ret = hljsDefineShExC(highlightjs, 'tripleConstraint');
        ret.disableAutodetect = true;
        return ret;
      }

      function init () {
        if (inited) return;
        inited = true;
        ([400, 800, 1600]).forEach(
          tOut => setTimeout(highlightAll, tOut)
        )
      }

      function highlightAll () {
        console.log(new Date())
        try {
          const blocks = document.querySelectorAll('.shexc,.turtle');
          [].forEach.call(blocks, (b) => {
            hljs.highlightBlock(b);
          });
        } catch (e) {}
      }
    </script>
  </body>
</html>
